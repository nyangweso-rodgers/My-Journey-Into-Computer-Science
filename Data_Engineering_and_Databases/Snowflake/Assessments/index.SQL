select 
    distinct t.ID as TREATMENT_ID,
    i.ID as INVOICE_ID,
    
    DATE(t.DATE_TREATMENT) AS DATE_TREATMENT,
    DATE(t.DATE_SUBMITTED) AS DATE_SUBMITTED,
    TIME(t.DATE_TREATMENT) AS TIME_TREATMENT,
    TIME(t.DATE_SUBMITTED) AS TIME_SUBMITTED,
    t.PROVIDER_REF_ID,
    
    t.STATUS as TREATMENT_STATUS,
    td.STATUS as TREATMENT_DIAGNOSIS_STATUS,
    d.STATUS as DIAGNOSIS_STATUS,
    p.STATUS AS PRODUCT_STATUS,
    ii.STATUS AS INVOICE_ITEM_STATUS,
    
    t.ACCOUNT_HOLDER_REF_ID,
    t.BENEFICIARY_REF_ID,
    t.COUNTRY_CODE,
    t.GENDER,
    
    d.DIAGNOSIS_CODE,
    d.DIAGNOSIS_NAME,
    p.SERVICE_TYPE,
    
    p.TYPE as PRODUCT_TYPE,
    p.BRAND_ID,
    p.PACK_SIZE_ID,
    P.PRODUCT_CODE,
    p.SERVICE_CODE,
    P.PRODUCT_NAME,
    
    ii.ITEM_CURRENCY AS INVOICE_ITEM_CURRENCY,
    ii.QUANTITY as INVOICE_ITEM_QUANTITY,
    ii.DISCOUNT_DESCRIPTION,
    ii.DISCOUNT_AMOUNT,
   ii.ITEM_AMOUNT as INVOICE_ITEM_AMOUNT,
   
   t.FINGERPRINT_VERIFIED,
   t.FINGERPRINT_VERIFICATION_BYPASS,
   ii.APPROVED_AMOUNT,
   p.PRICE_AMOUNT as PRODUCT_PRICE_AMOUNT
FROM CP_TRAIN_DB.RAW_DATA.TREATMENT t
left join CP_TRAIN_DB.RAW_DATA.TREATMENT_DIAGNOSIS td on t.ID = td.TREATMENT_ID 
left join CP_TRAIN_DB.RAW_DATA.DIAGNOSIS d on td.DIAGNOSIS_REF_ID = d.DIAGNOSIS_ID 
left join CP_TRAIN_DB.RAW_DATA.INVOICE i on t.ID = i.TREATMENT_ID 
left join CP_TRAIN_DB.RAW_DATA.INVOICE_ITEM ii on i.ID = II.INVOICE_ID
left join CP_TRAIN_DB.RAW_DATA.PRODUCT p on ii.PRODUCT_REF_ID = p.ID
--where ACCOUNT_HOLDER_REF_ID = '16083766' and t.ID = '793466' -- For Testing
order by TREATMENT_ID, DIAGNOSIS_CODE, DIAGNOSIS_NAME